---
title: "Messy Biographies to Clean Data - Structuring Text with LLMs and Pydantic"
subtitle: "FOO CAFE 13 years strong"
date: today
author: 
  - "Jonathan Jayes"
title-slide-attributes:
  # data-background-image: "assets/preview_wide.png"
  data-background-position: "bottom 10"
  data-background-size: "90%"
  data-background-opacity: "0.7"
  data-background-color: "#3B8C41"
format: 
  revealjs:
    theme: [default, assets/clean.scss]
    code-overflow: wrap
    width: 1600
    height: 900
    fig-align: center
    default-image-extension: svg
    slide-number: c
    code-block-bg: true
    code-block-border-left: "#31BAE9"
    include-in-header: 
        - text: <link rel = "shortcut icon" href = "assets/favicon.ico" />

image: "assets/preview_wide.png"
favicon: "assets/favicon.ico"
execute: 
  eval: true
  echo: false
bibliography: references.bib

---

## Agenda


1. Whirlwind tour through Swedish economic history

2. Messy Biographies to Clean Data

<!-- 3. Classification of occupational titles -->

. . . 

### Goals

1. Teach you something you didn't know about Sweden's economic history

2. Show how we make use of modern data science tools in academia

<!-- 3. Share some learnings from academia RE off the shelf software -->

## About me 

::: {.columns}
::: {.column}

- PhD student in Economic History at Lund

- Work on economic development in Sweden and tools to turn archival data into stories

- Work part time as a data scientist at [Codera Analytics](https://codera.co.za/)

- From South Africa originally

:::
::: {.column}

```{r}
knitr::include_graphics("assets/jj_run.jpeg")
```

:::
::: 


# Whirlwind tour through Swedish economic history{visibility="uncounted" #sec-whirlwind-tour background-color="#1b9e77"}

![](assets/aYWyRzV_700bwp.jpeg)


## When did Sweden become richðŸ‡¸ðŸ‡ªðŸ’¸?

:::{.center}

```{r}
knitr::include_graphics("figures/ed_step1_sweden.png")
```

:::
. . .

We need more context

## When did Sweden become richðŸ‡¸ðŸ‡ªðŸ’¸?

:::{.center}

```{r}
knitr::include_graphics("figures/ed_step2_sweden_vs_all.png")
```

:::

Versus the rest of the world

## When did Sweden become richðŸ‡¸ðŸ‡ªðŸ’¸?

:::{.center}

```{r}
knitr::include_graphics("figures/ed_step5_sweden_uk_sa_vs_all.png")
```

:::

Versus the first industrializing country ðŸ‡¬ðŸ‡§ and South Africa ðŸ‡¿ðŸ‡¦

## Why did Sweden become richðŸ‡¸ðŸ‡ª?

. . .

```{mermaid}
%%{init: {
  "theme": "base",
  "themeVariables": {
    /* Dark2 palette */
    "ganttCritTaskColor": "#1b9e77",        /* Phase 1 */
    "ganttCritTaskTextColor": "#ffffff",
    "ganttCritTaskBorderColor": "#1b9e77",

    "ganttActiveTaskColor": "#d95f02",      /* Phase 2 */
    "ganttActiveTaskTextColor": "#ffffff",
    "ganttActiveTaskBorderColor": "#d95f02",

    "ganttDoneTaskColor": "#7570b3",        /* Phase 3 */
    "ganttDoneTaskTextColor": "#ffffff",
    "ganttDoneTaskBorderColor": "#7570b3",

    "lineColor": "#888",
    "primaryColor": "#f5f5f5",
    "primaryBorderColor": "#888",
    "fontSize": "14px"
  }
}}%%

gantt
  title Sweden's Economic Development c. 1850â€“1975
  dateFormat  YYYY
  axisFormat  %Y

  %% Milestones (neutral)
  section Milestones
  Second Industrial Revolution begins :milestone, M1, 1890, 0d
  Post-war reconstruction era starts  :milestone, M2, 1945, 0d
  Swedish Golden Age winds down       :milestone, M3, 1975, 0d

  %% Phase 1 -> tag: crit (teal)
  section Foundations and First Industrial Wave
  Agrarian reforms and institutions   :crit, A1, 1820, 1870
  Export-led growth timber iron oats  :crit, A2, 1850, 1890
  National railway build-out state-led:crit, A3, 1855, 1895

  %% Phase 2 -> tag: active (orange)
  section Second Industrial Revolution
  Rise of engineering multinationals ASEA SKF Ericsson :active, B1, 1890, 1925
  American technology transfer learning-returning engineers :active, B2, 1900, 1935
  Taylorist methods diffuse           :active, B3, 1910, 1935
  US FDI and mass-production plants   :active, B4, 1910, 1930

  %% Phase 3 -> tag: done (purple)
  section Golden Age and the Swedish Model
  Post-war boom                       :done, C1, 1945, 1965
  Swedish Model consolidates          :done, C2, 1950, 1975
  Fordism at scale                    :done, C3, 1950, 1970


```

. . .

Many reasons!!

## Why did Sweden become richðŸ‡¸ðŸ‡ª?

### My preferred explanation: Sweden's Electrification

![](assets/map_big_power_stations.jpeg){fig-align="center"}

## Why did Sweden become richðŸ‡¸ðŸ‡ª?{visibility="uncounted" transition="none"}

### My preferred explanation: Sweden's Electrification

![](assets/map_big_power_stations_line_1900.jpeg){fig-align="center"}

## Why did Sweden become richðŸ‡¸ðŸ‡ª?{visibility="uncounted" transition="none"}

### My preferred explanation: Sweden's Electrification

![](assets/map_big_power_stations_line_1911.jpeg){fig-align="center"}

## Why did Sweden become richðŸ‡¸ðŸ‡ª?{visibility="uncounted" transition="none"}

### My preferred explanation: Sweden's Electrification

![](assets/map_big_power_stations_line_1926.jpeg){fig-align="center"}

## Why did Sweden become richðŸ‡¸ðŸ‡ª?{visibility="uncounted" transition="none"}

### My preferred explanation: Sweden's Electrification

![](assets/schon-energy-share.jpeg){fig-align="center"}


## Why did Sweden become richðŸ‡¸ðŸ‡ª?{visibility="uncounted" transition="none"}

### My preferred explanation: Sweden's Electrification

::::{.columns}

:::{.column width=50%}

![Income shares from @bengtsson2021WhatHappenedIncomes and rural electrification rates from @vattenfall1948ProcentuelltAntalElektrifierade](figures/00-electrification_and_inequality_line_and_stacked_bar_secondary_axis.png){width=600}

:::

:::{.column width=50%}

![](figures/2IR_1.JPG){.fragment}

![](figures/2IR_2.JPG){.fragment}


:::

::::

:::{.notes}

So why do we care about Sweden as a case study when we think about technological transformations? 


there are at least two reasons; 1 - Sweden was a fast adopter of electricity. After Jonas WenstrÃ¶m discovered three phase current in the late 19th century, Sweden rapidly electrified - with the electrification of rural areas advancing rapdily between 1900 and 1921, when the Western line - an important part of the grid, was completed. 

Second, Sweden in the early 20th century was undergoing a levelling in terms of inequality; we can see that the share of income going to to the top decile of the income distribution declined - so it is an intersting time with a great levelling taking place. 

Further, electrification as a general purpose technology drastically changed that way that we worked and lived; agricultural tasks that used to be very labour intensive were mechanised and then electrified, freeing up labour to move in to factories - which also were completely transformed by the electric motor, improving the quality of the jobs in the factory compared to the risks of belt drives from a central drive shaft, and allowing modular factory production, running only some machines at a time. 

:::

## Why did Sweden become richðŸ‡¸ðŸ‡ª?

### Learning and returning (GrÃ¶nberg 2003)

:::{.column-page}

```{=html}
<iframe src="assets/swedish_engineers_knowledge_transfer.html" width="100%" height="800px" style="border:none;"></iframe>
```

:::

## Why did Sweden become richðŸ‡¸ðŸ‡ª?

To answer the question of why Sweden became rich, we need to get data from source material from the time. 

:::: {.columns}

::: {.column width=33%}

<!-- ```{r}
knitr::include_graphics(here::here("assets/reading_ransom.jpg"))
``` -->

![](assets/reading_ransom.jpg){fig-align="center" width=100%}


:::

::: {.column width=33%}

<!-- ```{r}
knitr::include_graphics(here::here("assets/Electrolux_1950_page_5.jpeg"))
``` -->

![](assets/Electrolux_1950_page_5.jpeg){fig-align="center" width=100%}

:::

::: {.column width=33%}

<!-- ```{r}
knitr::include_graphics(here::here("assets/vem_page copy.png"))
``` -->

![](assets/vem_page copy.png){fig-align="center" width=100%}
:::

:::: 

# Messy Biographies to Clean Data{visibility="uncounted" #sec-structuring-data background-color="#1b9e77"}



## Who is who?

:::: {.columns}

::: {.column width="70%"}

Vem Ã¤r Vem? is a **Swedish biographical encyclopedia** that was published in two editions of five volumes each in 1945â€“1950 and 1962â€“1968 by BokfÃ¶rlaget Vem Ã¤r Vem.

The intention was, according to the publishers, to draw attention **to people who were at the height of their activities**, even if they were younger, in influential or otherwise noted positions in different areas.

- Biographies and career trajectories of ~ 75,000 individuals!

- 8 of the 10 volumes are digitized by librarians in Uppsala â€“ thank you <3

:::

::: {.column width="5%"}

:::

::: {.column width="25%"}

![](assets/vem_cover.png){fig-align="center" width=100%}

:::

::::

## Vem Ã¤r Vem? Volumes

![](assets/who-is-who-volumes.png){fig-align="center" width=100%}

```{r}
#| eval: false
library(tidyverse)
theme_set(theme_light())
library(ggtext)
library(showtext)
font_add_google("IBM Plex Mono", "ibm")
showtext_auto(enable = TRUE)

# Create a tibble from the JSON data
books <- tibble(
  book_name = c("SkÃ¥ne", "Stockholm", "Svealand", "The GÃ¶taland region except SkÃ¥ne", "SkÃ¥ne", "Norrland", "Stockholm", "The GÃ¶taland region except SkÃ¥ne", "Who is who in indsutry and business?"),
  year = c(1948, 1962, 1964, 1965, 1966, 1968, 1945, 1948, 1945),
  pages = c(624, 1498, 945, 1203, 952, 1340, 1044, 1075, 625),
  volume = c(1, 2, 2, 2, 2, 2, 1, 1, 3)
) 

books <- books %>%
    mutate(name = str_c(book_name, " - ", year),
            name = fct_reorder(name, pages),
            records = pages * 8) %>%
            mutate(volume = case_when(
                volume == 1 ~ "1945â€“1950", 
                volume == 2 ~"1962â€“1968",
                TRUE ~ "Who is who in indsutry and business?")
            ) %>%
    select(name, records, volume) 

# books %>% summarise(records = sum(records))

# Create the ggplot visualization
ggplot(books, aes(x = records, y = name, fill = factor(volume))) +
  geom_col(alpha = .8) +
  labs(x = "Number of biographies", y = "Book volume",
  title = "Number of biographies in Vem Ã¤r Vem?",
  fill = "Edition") +
  scale_x_continuous(labels = scales::number_format()) +
  scale_fill_manual(values = c("#2B8CBE", "#be5d2b", "midnightblue"))  +
    theme(plot.title.position = "plot") +
    theme(legend.position = "bottom") +
    theme(text = element_text(family = "ibm", size = 24))

ggsave("assets/who-is-who-volumes.png", width = 6, height = 4, units = "in", dpi = 300)
```


## Vem Ã¤r Vem? Example page

![](assets/vem_page.png){fig-align="center" width=100%}

## Vem Ã¤r Vem? Example biography

![](assets/vem_page close-up.jpg){fig-align="center" width=100%}

## Vem Ã¤r Karl Lund?

Lund, Karl Gustaf, chief engineer, living in Varberg, born on July 22, 1893, in Hille, GÃ¤vle County, Sweden, son of clerk Ferdinand L. and Maria Andersson. Married in 1936 to Sigrid Johansson. Children: Ingvar (born 1938), Lennart (born 1942). â€” Graduated from Bergsskolan in Filipstad in 1917, specialized studies at the Royal Institute of Technology (KTH) from 1920 to 1922, studied at the Institute of Metallurgy and Stockholm University in 1921-1922. Chemist at StrÃ¶msnÃ¤s JÃ¤rnverks A-B in Degerfors from 1918 to 1920, metallurgist and chemist at Westinghouse Electric & Manufacturing Co. in East Pittsburgh, PA, USA, from 1923 to 1926 and 1928 to 1929, chief metallurgist at Laclede Steel Co. in Alton, Illinois, USA, in 1927, furnace and steelworks engineer at A-B Iggesunds Bruk from 1929 to 1931, site manager at Gunnebo Bruks Nya A-B, Varbergsverket, since 1931. Member of the municipal executive committee, deputy chairman of the economic department, deputy member of the board of the power plant, chairman of Varbergs Sparbank, employer representative in the district council of the county labor board, member of the board of Varbergs LuftskyddsfÃ¶rening (Varberg Air Protection Association), secretary of Varbergs HÃ¶gerfÃ¶rening (Varberg Conservative Association), chairman of the railway sick fund, and Plant Society for Small Bird Friends.

## Vem Ã¤r Karl Lund?

[Lund, Karl Gustaf]{style="background-color: #b0c4de"}, [chief engineer]{style="background-color: #d2b48c"}, [living in Varberg]{style="background-color: #d28ccdff"}, [born on July 22, 1893]{style="background-color: #ff8c69"}, [in Hille, GÃ¤vle County]{style="background-color: #e8ee90ff"}, Sweden, son of [clerk Ferdinand L. and Maria Andersson]{style="background-color: #9370db"}. Married in 1936 to [Sigrid Johansson]{style="background-color: #ffadc1"}. Children: [Ingvar (born 1938)]{style="background-color: #ffdead"}, [Lennart (born 1942)]{style="background-color: #ffdead"}. â€” Graduated from [Bergsskolan]{style="background-color: #afeeee"} in Filipstad in 1917, specialized studies at the [Royal Institute of Technology (KTH)]{style="background-color: #afeeee"} from 1920 to 1922, studied at the [Institute of Metallurgy]{style="background-color: #afeeee"} and [Stockholm University]{style="background-color: #afeeee"} in 1921-1922. Chemist at [StrÃ¶msnÃ¤s JÃ¤rnverks A-B]{style="background-color: #98fb98"} in Degerfors from 1918 to 1920, metallurgist and chemist at [Westinghouse Electric & Manufacturing Co.]{style="background-color: #98fb98"} in East Pittsburgh, PA, USA, from 1923 to 1926 and 1928 to 1929, chief metallurgist at [Laclede Steel Co.]{style="background-color: #98fb98"} in Alton, Illinois, USA, in 1927, furnace and steelworks engineer at [A-B Iggesunds Bruk]{style="background-color: #98fb98"} from 1929 to 1931, site manager at [Gunnebo Bruks Nya A-B, Varbergsverket]{style="background-color: #98fb98"}, since 1931. Member of the municipal executive committee, deputy chairman of the economic department, deputy member of the board of the power plant, chairman of [Varbergs Sparbank]{style="background-color: #ffdab9"}, employer representative in the district council of the county labor board, member of the board of [Varbergs LuftskyddsfÃ¶rening (Varberg Air Protection Association)]{style="background-color: #ffdab9"}, secretary of [Varbergs HÃ¶gerfÃ¶rening (Varberg Conservative Association)]{style="background-color: #ffdab9"}, chairman of the railway sick fund, and [Plant Society for Small Bird Friends]{style="background-color: #ffdab9"}. 

## Vem Ã¤r Karl Lund?

Traveled to [Germany]{style="background-color: #e6e6fa"} in 1921, 1923, 1930, and 1936, [Denmark]{style="background-color: #e6e6fa"}, [Czechoslovakia]{style="background-color: #e6e6fa"} in 1921, 1922, and 1923, [Austria]{style="background-color: #e6e6fa"} in 1921, and the [USA]{style="background-color: #e6e6fa"} from 1923 to 1929. Writings: ["Some fundamental factors for obtaining sharp thermal curves" (Transactions of the American Society for Steel Treating, co-authored with C. Benedicks and W. H. Dearden, 1925)]{style="background-color: #74b7ffff"}, ["Contemporary production of saw blades, circular saws, and machine knives" (Timber Industry, 1931)]{style="background-color: #74b7ffff"}. Hobbies: [hunting]{style="background-color: #ffd700"} and [fishing]{style="background-color: #ffd700"}.


## Goal

```{r}
knitr::include_graphics(here::here("assets/methods.png"))
```


# How can we `structure` the data?{#sec-structure background-color="#1C9E77" visibility="uncounted"}

## Why does a rules-based approach not work?

### NLP challenges

:::: {.columns}

::: {.column width="50%"}

<br>

- Many abbreviations and contractions
    - DOB: "f\.\\s*(\\d{2})\\/(\\d{2})/(\\d{2})"
    - GÃ¤vleborg County: "GÃ¤vleb. l."

- Similar structure for each entry but not exactly the same information in the same order


:::

::: {.column width="50%"}

<br>

![](assets/Karl_Lund_crop.png){fig-align="center"}

:::

::::

## Why not treat it as a Named Entity Recognition (NER) problem?

### Using `Prodigy` can help us label data quickly

:::{.column-page}

```{=html}
<iframe src="assets/prodigy-clone.html" width="100%" height="800px" style="border:none;"></iframe>
```

:::

## Why not treat it as a Named Entity Recognition (NER) problem?

### We want to keep relations between parts of the text

```{python, eval=FALSE, echo=TRUE}
import prodigy
from prodigy import recipe

@recipe("biographical-relations")
def biographical_relations(dataset, source, model):
    def add_relations(examples):
        for eg in examples:
            # Present entities and relationship options
            eg["relations"] = [
                {"head": "Karl Lund", "tail": "Varberg", "label": "LIVES_IN"},
                {"head": "Karl Lund", "tail": "Hille", "label": "BORN_IN"}
            ]
            yield eg
    
    return {
        "dataset": dataset,
        "stream": add_relations(source),
        "view_id": "relations"
    }

```

## What do we need to do the data structuring with an LLM?

1. Prompt

2. Schema for Output

3. Large Language Model to structure output

4. Quality Assurance


## 1. Prompt

#### Components:

1. Role

*You are an expert on Swedish biographies.*

2. Task

*You will help me structure the following Swedish biographies from the biographical dictionary 'Vem Ã¤r Vem'., according to the provided schema.*

3. Details

- *Keep the biographic descriptions in Swedish and remove any abbreviations based on your knowledge, e.g. 'fil. kand.' is 'filosofie kandidat', and 'Skarab. l.' is 'Skaraborgs LÃ¤n' etc.*
- *For missing data in a required field, include the field with a `None` value.*
- *Put years in full based on context. Put dates in DD-MM-YYYY format where possible.*


## 2. Schema for Output

:::: {.columns}

::: {.column}

### Before pydantic

Prompt:

*Can you put the following into a json schema following the https://schema.org/Person format?*

Output:

```{r}
#| eval: FALSE
#| echo: TRUE

Hereâ€™s a structured JSON-LD schema (using schema.org/Person
) representation of the biography you gave. Iâ€™ve nested occupations, education, family, and memberships in a way that aligns with schema.org, while keeping extra details in description when no direct property exists

```json

{
  "@context": "https://schema.org",
  "@type": "Person",
  "name": "Karl Gustaf Lund",
  "givenName": "Karl Gustaf",
  "familyName": "Lund",
  "birthDate": "1893-07-22",
  "birthPlace": {
    "@type": "Place",
    "name": "Hille, GÃ¤vle County, Sweden"
  },
  "address": {
    "@type": "PostalAddress",
    "addressLocality": "Varberg",
    "addressCountry": "Sweden"
  },



```


:::

::: {.column}

Problem:

- Schema is not uniform (in fields) across biographies, combining the information is tedious

- Answer from LLM is often pre-pended with text, not just JSON

- So saving the output as JSON and reading it in is not straightforward

:::

::::

## 2. Schema for Output

### With pydantic

```{python, eval=FALSE, echo=TRUE}

class Occupation(BaseModel):
    occupation: str = Field(..., description="Occupation in Swedish")
    occupation_english: Optional[str] = Field(None, description="Occupation translated into English")

class Parent(BaseModel):
    name: str = Field(..., description="Parent's name")
    occupation: Optional[Occupation] = Field(None, description="Parent's occupation title")

...


class BioSchema(BaseModel):
    full_name: str = Field(..., description="Full name of the person")
    location: Optional[str] = Field(None, description="Location associated with the person")
    occupation: Occupation = Field(..., description="Occupation details of the person")
    birth_details: BirthDetails = Field(..., description="Details about the person's birth")
    education: Optional[List[EducationItem]] = Field(None, description="List of educational qualifications")
    career: List[CareerItem] = Field(..., description="Career history of the person")
    family: Optional[Family] = Field(None, description="Family details including spouse and children")
    publications: Optional[List[Publication]] = Field(None, description="List of publications")
    community_involvement: Optional[List[CommunityInvolvement]] = Field(None, description="Community roles and involvement")
    board_memberships: Optional[List[BoardMembership]] = Field(None, description="Board memberships held by the person")
    honorary_titles: Optional[List[HonoraryTitle]] = Field(None, description="List of honorary titles received")
    hobbies: Optional[List[str]] = Field(None, description="List of hobbies")
    travels: Optional[List[Travel]] = Field(None, description="Travel details")
    awards: Optional[List[str]] = Field(None, description="List of awards received")
    leadership_roles: Optional[List[str]] = Field(None, description="List of leadership roles held")
    languages_spoken: Optional[List[str]] = Field(None, description="Languages spoken by the person")
    military_service: Optional[str] = Field(None, description="Military service details")
    honors: Optional[str] = Field(None, description="Honors received by the person")
    death_date: Optional[str] = Field(None, description="Date of death")

```


## 3. Large Language Model to structure output{.smaller}

### Many to choose from!

| Model | Company | Environment |
|-------|---------|-------------|
| GPT-3.5 | OpenAI | Cloud |
| GPT-4o | OpenAI | Cloud |
| GPT-4o mini | OpenAI | Cloud |
| Gemini 1.5 Pro | Google | Cloud |
| Gemini 1.5 Flash | Google | Cloud |
| Gemini 2.0 Flash | Google | Cloud |
| Gemini 2.5 Pro | Google | Cloud |
| Llama 3.2 | Meta | Local and Cloud |


```{mermaid}
%%{init: {'theme': 'base', 'themeVariables': { 'fontSize': '16px' }}}%%
gantt
    title Chat Model Release Timeline
    dateFormat  YYYY-MM-DD
    axisFormat %Y-%m

    section OpenAI
    GPT-3.5           :done, 2023-03-27, 1d
    GPT-4o            :done, 2024-05-13, 1d
    GPT-4o mini       :done, 2024-07-18, 1d
    

    section Google
    Gemini 1.5 Pro    :done, 2024-02-15, 1d
    Gemini 1.5 Flash  :done, 2024-05-14, 1d
    Gemini 2.0 Flash  :active, 2025-01-30, 1d
    Gemini 2.5 Pro    :active, 2025-03-25, 1d

    section Meta
    Llama 3.2         :active, 2025-08-13, 1d
```

## 4. Quality Assurance{.smaller}

We need to label some data to check how well the structuring works

| Field Path                     | Ground Truth                 | Pipeline Output           | TP | FP | FN | Analysis                                                                     |
|:-------------------------------|:-----------------------------|:--------------------------|:--:|:--:|:--:|:-----------------------------------------------------------------------------|
| `full_name`                    | `Karl Gustaf Lund`           | `Karl Gustaf Lund`        | 1  | 0  | 0  | **Correct**: Perfect match.                                                  |
| `birth_details.place`          | `Hille, GÃ¤vleborgs lÃ¤n`      | `Hille, GÃ¤vle County`     | 0  | 1  | 1  | **Incorrect**: Similar but not an exact match. Scored as a miss and a mistake. |
| `education` (list)             | 3 items                      | 0 items                   | 0  | 0  | 3  | **Missed**: Failed to extract any education entries.                         |
| `career` (list)                | 6 items                      | 2 items                   | 1  | 1  | 5  | **Partial**: Found 1/6 correctly, hallucinated 1, and missed the other 5.    |
| `family.spouse.birth_date`     | `null`                       | `1936`                    | 0  | 1  | 0  | **Hallucination**: Extracted marriage year as a non-existent birth date.      |
| `family.children` (list)       | 2 items                      | 1 item                    | 1  | 0  | 1  | **Partial**: Found 1 of the 2 children and missed the other.                 |
| **Totals** |                              |                           | **3** | **3** | **10** |  |

## Performance

### Based on a sample of 2000 hand-labeled and scored biographies

<br>

| Model | Company | Environment | Precision | Recall | F1-Score |
|-------|---------|-------------|-----------|--------|----------|
| GPT-3.5 | OpenAI | Cloud | 46% | 72% | 56% |
| GPT-4o mini | OpenAI | Cloud | 72% | 78% | 75% |
| Llama 3.2 | Meta | Local and Cloud | 75% | 81% | 78% |
| Gemini 2.5 Pro | Google | Cloud | 88% | 90% | 89% |

## Performance

::: {.columns}

::: {.column}

- Manually labelling and scoring 2,000 biographies took about three weeks of full-time work.

- To do the 75,000 biographies in Vem Ã¤r Vem would take about 1.5 years, just to collect.

- Once this system is in place, we can run the structuring on new biographies in a matter of minutes

:::

::: {.column}

![](assets/wikihow.jpeg)

:::

:::





# What do we learn?{#sec-learnings background-color="#1C9E77" visibility="uncounted"}

(about the engineers?)

## What do we learn?

```{r}
library(ggtext)
library(showtext)
library(tidyverse)
font_add_google("IBM Plex Mono", "ibm")
theme_set(theme_light())
showtext_auto(enable = TRUE)

timeline <- tibble(
  event = c("Birth", "Graduated from Bergsskolan in Filipstad", 
            "Specialized studies at the Royal Institute of Technology (KTH)",
            "Studied at the Institute of Metallurgy and Stockholm University",
            "Marriage to Sigrid Johansson",
            "Birth of Ingvar", "Birth of Lennart",
            "Chemist at StrÃ¶msnÃ¤s JÃ¤rnverks A-B in Degerfors",
            "Metallurgist and chemist at Westinghouse Electric & Manufacturing Co.",
            "Chief metallurgist at Laclede Steel Co. in Alton, Illinois, USA",
            "Furnace and steelworks engineer at A-B Iggesunds Bruk",
            "Site manager at Gunnebo Bruks Nya A-B, Varbergsverket",
            "Member of the municipal executive committee",
            "Deputy chairman of the economic department",
            "Deputy member of the board of the power plant",
            "Chairman of Varbergs Sparbank",
            "Employer representative in the district council of the county labor board",
            "Member of the board of Varbergs LuftskyddsfÃ¶rening",
            "Secretary of Varbergs HÃ¶gerfÃ¶rening",
            "Chairman of the railway sick fund",
            "Plant Society for Small Bird Friends",
            "Traveled to Germany",
            "Traveled to Denmark and Czechoslovakia",
            "Traveled to Austria",
            "Traveled to the USA",
            "*Wrote 'Some fundamental factors for obtaining sharp thermal curves'",
            "*Wrote 'Contemporary production of saw blades, circular saws, and machine knives'",
            "Hobbies: hunting and fishing"
  ),
  start_year = c(1893, 1917, 1920, 1921, 1936, 1938, 1942, 1918, 1923, 1927, 1929,
                 1931, NA, NA, NA, NA, NA, NA, NA, NA, NA, 1921, 1921, 1921, 1923, 1925, 1931, NA),
  end_year = c(1893, 1917, 1922, 1922, 1936, 1938, 1942, 1920, 1929, 1927, 1931,
               NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 1923, 1923, 1921, 1929, NA, NA, NA)
)

timeline %>%
    filter(!is.na(start_year)) %>%
  arrange(start_year) %>%
  mutate(end_year_imputed = case_when(
    is.na(end_year) ~ lead(start_year),
    is.na(lead(start_year)) ~ start_year,
    TRUE ~ end_year
  )) %>%
  mutate(
    event = fct_reorder(event, start_year, .desc = TRUE)
  ) %>%
  # pivot_longer(c(start_year, end_year_imputed)) %>%
  # ggplot(aes(value, english_occupation, colour = name)) +
  ggplot(aes(xmin = start_year, xmax = end_year_imputed, y = event)) +
  geom_linerange(colour = "gray50", size = 2) +
  geom_point(aes(x = end_year_imputed), colour = "#be5d2b", size = 4) +
  geom_point(aes(x = start_year), colour = "#2B8CBE", size = 4) +
  labs(
    title = "Karl Lund's life course",
    subtitle = "Showing <span style = 'color:#2B8CBE;'>start dates</span> and <span style = 'color:#be5d2b;'>end dates</span> for his various roles and life events",
    x = NULL,
    y = NULL
  ) +
  theme(
    legend.position = "none",
    plot.subtitle = element_markdown(),
    plot.title.position = "plot",
    text = element_text(family = "ibm", size = 13)
  )



```


## What do we learn?

### Engineers in `electrical appliances and machinery` move the furthest from birthplace to study

![](assets/engineer_distance.png){fig-align="center" width=100%}

## What do we learn?


::: {.columns}
::: {.column}

- 4,700 Swedes who studied engineering moved to the USA and returned between 1890 and 1960.

- Of those engineers who move to the USA and return, about 30% of them return to Sweden within 5 years, and about 90% return within 10 years.

- They work on average at 2.1 different companies while in the USA.

- When they get back to Sweden, two-thirds of key positions in industry were held by engineers with foreign experience.

- The firms that hire returning engineers saw faster growth in employment than firms that did not hire returning engineers.

:::

::: {.column}

```{r}
knitr::include_graphics("assets/p4_2.png")
```

:::
::: 


# What did we learn?{#sec-what-did-we-learn background-color="#1C9E77" visibility="uncounted"}

(about data structuring tasks?)

## There is a lot of unstructured historical data out there!

::: {.columns}
::: {.column}

![](assets/world_champtions.jpeg){fig-align="center" width=100%}

:::
::: {.column}

- I am sure that in your own work, there is a lot of unstructured data that you would like to use for some purpose.

- Investing a bit of time in setting up a system to structure that data can pay off in the long run - and save you **~ 1.5 years of manual labour**

- These kinds of tasks are going to become easier and easier to do as LLMs improve - the kinds of questions you can ask are going to become more interesting!

:::
::: 




## References{visibility="uncounted"}

::: {#refs}

:::

## Appendix{visibility="uncounted"}

